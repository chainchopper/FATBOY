<div class="profile-container">
  <div *ngIf="(currentUser$ | async) as user; else notLoggedIn">
    <div *ngIf="(userProfile$ | async) as profile" class="profile-card">
      <div class="profile-header">
        <img [src]="profile.avatar_url" alt="User Avatar" class="avatar">
        <button class="edit-profile-btn" routerLink="/profile/edit">Edit Profile</button>
      </div>
      <h2>{{ profile.first_name }} {{ profile.last_name }}</h2>
      <p class="email">{{ user.email }}</p>
      
      <div class="profile-section stats-section" *ngIf="(leaderboardStats$ | async) as stats">
        <div class="stat-item">
          <span class="stat-value">{{ stats.rank || 'N/A' }}</span>
          <span class="stat-label">Global Rank</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ stats.score || 0 }}</span>
          <span class="stat-label">Total Score</span>
        </div>
        <button class="leaderboard-btn" routerLink="/leaderboard">View Leaderboard</button>
      </div>

      <div class="profile-section">
        <h3>Your Badges</h3>
        <div class="badges-grid">
          <div *ngFor="let badge of (badges$ | async)" class="badge-item" [class.unlocked]="badge.unlocked">
            <span class="badge-icon">{{ badge.icon }}</span>
            <span class="badge-name">{{ badge.name }}</span>
          </div>
        </div>
      </div>
      
    </div>
  </div>
  
  <ng-template #notLoggedIn>
    <div class="empty-state">
      <p>Please log in to view your profile.</p>
    </div>
  </ng-template>
</div>