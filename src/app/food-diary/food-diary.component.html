<div class="diary-container">
  <div class="diary-header">
    <h2>Food Diary</h2>
    <div class="date-navigator">
      <button (click)="goToPreviousDay()" class="nav-button">‚óÄÔ∏è Previous Day</button>
      <span class="current-date">{{ currentDate | date:'fullDate' }} <span *ngIf="isToday()">(Today)</span></span>
      <button (click)="goToNextDay()" class="nav-button" [disabled]="isToday()">Next Day ‚ñ∂Ô∏è</button>
    </div>
  </div>

  <app-daily-summary-card
    [summary]="dailySummary"
    [verdict]="dailyVerdict"
    [preferences]="userPreferences">
  </app-daily-summary-card>

  <div class="diary-grid">
    <div class="meal-section">
      <div class="meal-header">
        <h3>üç≥ Breakfast</h3>
        <button (click)="scanForMeal('Breakfast')" class="scan-meal-btn">Scan Item</button>
      </div>
      <div *ngIf="(breakfast$ | async) as entries" class="meal-list">
        <app-diary-item 
          *ngFor="let entry of entries"
          [product]="entry.product"
          (remove)="onRemoveEntry(entry.id)"
          (viewDetails)="onViewDetails($event)"> <!-- Bind new event here -->
        </app-diary-item>
        <p *ngIf="entries.length === 0" class="empty-meal">No breakfast items logged.</p>
      </div>
    </div>

    <div class="meal-section">
      <div class="meal-header">
        <h3>ü•ó Lunch</h3>
        <button (click)="scanForMeal('Lunch')" class="scan-meal-btn">Scan Item</button>
      </div>
      <div *ngIf="(lunch$ | async) as entries" class="meal-list">
        <app-diary-item 
          *ngFor="let entry of entries"
          [product]="entry.product"
          (remove)="onRemoveEntry(entry.id)"
          (viewDetails)="onViewDetails($event)"> <!-- Bind new event here -->
        </app-diary-item>
        <p *ngIf="entries.length === 0" class="empty-meal">No lunch items logged.</p>
      </div>
    </div>

    <div class="meal-section">
      <div class="meal-header">
        <h3>üç≤ Dinner</h3>
        <button (click)="scanForMeal('Dinner')" class="scan-meal-btn">Scan Item</button>
      </div>
      <div *ngIf="(dinner$ | async) as entries" class="meal-list">
        <app-diary-item 
          *ngFor="let entry of entries"
          [product]="entry.product"
          (remove)="onRemoveEntry(entry.id)"
          (viewDetails)="onViewDetails($event)"> <!-- Bind new event here -->
        </app-diary-item>
        <p *ngIf="entries.length === 0" class="empty-meal">No dinner items logged.</p>
      </div>
    </div>

    <div class="meal-section">
      <div class="meal-header">
        <h3>üçé Snacks</h3>
        <button (click)="scanForMeal('Snack')" class="scan-meal-btn">Scan Item</button>
      </div>
      <div *ngIf="(snacks$ | async) as entries" class="meal-list">
        <app-diary-item 
          *ngFor="let entry of entries"
          [product]="entry.product"
          (remove)="onRemoveEntry(entry.id)"
          (viewDetails)="onViewDetails($event)"> <!-- Bind new event here -->
        </app-diary-item>
        <p *ngIf="entries.length === 0" class="empty-meal">No snack items logged.</p>
      </div>
    </div>

    <div class="meal-section">
      <div class="meal-header">
        <h3>ü•§ Drinks</h3>
        <button (click)="scanForMeal('Drinks')" class="scan-meal-btn">Scan Item</button>
      </div>
      <div *ngIf="(drinks$ | async) as entries" class="meal-list">
        <app-diary-item 
          *ngFor="let entry of entries"
          [product]="entry.product"
          (remove)="onRemoveEntry(entry.id)"
          (viewDetails)="onViewDetails($event)"> <!-- Bind new event here -->
        </app-diary-item>
        <p *ngIf="entries.length === 0" class="empty-meal">No drinks logged.</p>
      </div>
    </div>
  </div>
</div>