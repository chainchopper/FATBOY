<div class="shopping-list-container">
  <div class="list-header">
    <h2>Your Shopping List</h2>
    <button (click)="clearList()" class="clear-btn">Clear All</button>
  </div>

  <div *ngIf="(unpurchasedItems$ | async) as unpurchasedList">
    <div *ngIf="unpurchasedList.length === 0 && (purchasedItems$ | async)?.length === 0" class="empty-state">
      <p>Your shopping list is empty. Add approved products from the results or saved pages!</p>
    </div>

    <div class="list-items-grid">
      <app-product-card 
        *ngFor="let item of unpurchasedList" 
        [product]="item.product!" 
        [isFavorite]="isFavorite(item.product!.id)"
        [showCheckbox]="true"
        [isPurchased]="item.purchased"
        [showRemoveButton]="true"
        [showShareButton]="true"
        [showAddToFoodDiaryButton]="true"
        (togglePurchased)="onTogglePurchased(item.id)"
        (remove)="onRemoveItem(item.id)"
        (share)="onShareProduct($event)"
        (addToFoodDiary)="onAddToFoodDiary($event)"
        (toggleFavorite)="toggleFavorite($event)"
      ></app-product-card>
    </div>

    <div *ngIf="(purchasedItems$ | async) as purchasedList">
      <div *ngIf="purchasedList.length > 0" class="purchased-section">
        <h3 class="purchased-header">Purchased Items ({{ purchasedList.length }})</h3>
        <div class="list-items-grid">
          <app-product-card 
            *ngFor="let item of purchasedList" 
            [product]="item.product!" 
            [isFavorite]="isFavorite(item.product!.id)"
            [showCheckbox]="true"
            [isPurchased]="item.purchased"
            [showRemoveButton]="true"
            [showShareButton]="true"
            [showAddToFoodDiaryButton]="true"
            (togglePurchased)="onTogglePurchased(item.id)"
            (remove)="onRemoveItem(item.id)"
            (share)="onShareProduct($event)"
            (addToFoodDiary)="onAddToFoodDiary($event)"
            (toggleFavorite)="toggleFavorite($event)"
          ></app-product-card>
        </div>
      </div>
    </div>
  </div>
</div>