<div class="history-container">
  <div class="history-header">
    <h2>Your Scan History</h2>
    <button (click)="clearHistory()" class="clear-btn">Clear All Scans</button>
  </div>

  <div class="stats-section" *ngIf="stats.length > 0">
    <h3>Most Frequently Avoided Ingredients</h3>
    <div class="stats-grid">
      <div *ngFor="let stat of stats.slice(0, 5)" class="stat-item">
        <span class="stat-count">{{stat.count}}</span>
        <span class="stat-ingredient">{{stat.ingredient}}</span>
      </div>
    </div>
  </div>

  <div class="category-filters">
    <button 
      (click)="filterByCategory(null)" 
      [class.active]="selectedCategory === null"
      class="category-btn">
      All Scans
    </button>
    <button 
      *ngFor="let category of ['natural', 'artificialSweeteners', 'artificialColors', 'preservatives']"
      (click)="filterByCategory(category)" 
      [class.active]="selectedCategory === category"
      class="category-btn">
      {{getCategoryIcon(category)}} {{category}}
    </button>
  </div>

  <div class="products-grid">
    <app-product-card 
      *ngFor="let product of filteredProducts"
      [product]="product"
      [showRemoveButton]="true"
      [showShareButton]="true"
      [showAddToShoppingListButton]="true"
      [showAddToFoodDiaryButton]="true"
      (remove)="removeProduct($event)"
      (share)="shareProduct($event)"
      (addToShoppingList)="addToShoppingList($event)"
      (addToFoodDiary)="addToFoodDiary($event)">
    </app-product-card>
    
    <div *ngIf="filteredProducts.length === 0" class="empty-state">
      <p>No scan history yet. Start scanning products to build your history!</p>
    </div>
  </div>
</div>