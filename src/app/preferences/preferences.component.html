<div class="preferences-container">
  <h2>Your Food Preferences</h2>
  
  <div class="preference-section">
    <h3>Ingredients to Avoid</h3>
    <p class="section-description">Select specific ingredients you want to avoid. Any product containing these will be marked as 'Denied'.</p>
    
    <div *ngFor="let category of ingredientCategories | keyvalue" class="ingredient-category">
      <h4>{{ category.value.name }}</h4>
      <div class="ingredient-grid">
        <div *ngFor="let item of category.value.items" class="preference-item">
          <input 
            type="checkbox" 
            [id]="item" 
            [checked]="isIngredientAvoided(item)"
            (change)="toggleAvoidIngredient(item)">
          <label [for]="item">{{ item | titlecase }}</label>
        </div>
      </div>
    </div>
  </div>

  <div class="preference-section">
    <h3>Custom Ingredients to Avoid</h3>
    <p class="section-description">Manually add any other ingredients you want to avoid.</p>
    <div class="custom-ingredient-form">
      <input 
        type="text" 
        [(ngModel)]="newCustomIngredient" 
        placeholder="e.g., carrageenan"
        (keyup.enter)="addCustomIngredient()">
      <button (click)="addCustomIngredient()" class="add-btn">Add</button>
    </div>
    <div class="custom-ingredient-list">
      <div *ngFor="let item of preferences.customAvoidedIngredients; let i = index" class="custom-ingredient-item">
        <span>{{ item }}</span>
        <button (click)="removeCustomIngredient(i)" class="remove-btn">Ã—</button>
      </div>
    </div>
  </div>
  
  <div class="preference-section">
    <h3>Set your limits:</h3>
    <div class="calorie-slider">
      <label for="maxCalories">Max Calories per Serving: {{preferences.maxCalories}}</label>
      <input type="range" id="maxCalories" min="0" max="500" step="10" [(ngModel)]="preferences.maxCalories">
    </div>
    <div class="calorie-slider">
      <label for="dailyCalorieTarget">Daily Calorie Target: {{preferences.dailyCalorieTarget}}</label>
      <input type="range" id="dailyCalorieTarget" min="1000" max="3000" step="100" [(ngModel)]="preferences.dailyCalorieTarget">
    </div>
  </div>
  
  <div class="preference-section">
    <h3>Your Goal:</h3>
    <div class="goal-selector">
      <input type="radio" id="strictlyNatural" name="goal" value="strictlyNatural" [(ngModel)]="preferences.goal">
      <label for="strictlyNatural">Strictly Natural</label>
      
      <input type="radio" id="avoidChemicals" name="goal" value="avoidChemicals" [(ngModel)]="preferences.goal">
      <label for="avoidChemicals">Avoid Chemicals</label>
      
      <input type="radio" id="calorieCount" name="goal" value="calorieCount" [(ngModel)]="preferences.goal">
      <label for="calorieCount">Calorie Count</label>
    </div>
  </div>

  <div class="preference-section">
    <h3>Privacy & Sharing</h3>
    <div class="preference-item">
      <input type="checkbox" id="shareUsername" [(ngModel)]="preferences.shareUsername">
      <label for="shareUsername">Show my name on community contributions</label>
    </div>
    <div class="preference-item">
      <input type="checkbox" id="shareGoal" [(ngModel)]="preferences.shareGoal">
      <label for="shareGoal">Show my health goal on contributions</label>
    </div>
    <div class="preference-item">
      <input type="checkbox" id="shareLeaderboardStatus" [(ngModel)]="preferences.shareLeaderboardStatus">
      <label for="shareLeaderboardStatus">Show my rank & score on contributions</label>
    </div>
  </div>
  
  <button class="save-btn" (click)="savePreferences()">Save Preferences</button>
</div>