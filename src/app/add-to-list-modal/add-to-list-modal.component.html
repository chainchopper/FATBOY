<div class="modal-overlay" [class.open]="(display$ | async) === 'open'" (click)="close()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="close-btn" (click)="close()">×</button>
    
    <div *ngIf="product$ | async as product">
      <h3>Add "{{ product.name }}" to a list</h3>
      
      <div *ngIf="!showMealOptions">
        <button class="modal-action-btn" (click)="addToShoppingList()">
          <span class="icon">🛒</span> Add to Shopping List
        </button>
        <button class="modal-action-btn" (click)="saveToApproved()">
          <span class="icon">❤️</span> Save to Approved
        </button>
        <button class="modal-action-btn" (click)="addToAvoidList()">
          <span class="icon">🚫</span> Add to Avoided
        </button>
        <button class="modal-action-btn" (click)="toggleMealOptions()">
          <span class="icon">🥗</span> Add to Food Diary
        </button>
      </div>

      <div *ngIf="showMealOptions">
        <h4>Which meal?</h4>
        <button class="modal-action-btn" (click)="addToDiary('Breakfast')">🍳 Breakfast</button>
        <button class="modal-action-btn" (click)="addToDiary('Lunch')">🥗 Lunch</button>
        <button class="modal-action-btn" (click)="addToDiary('Dinner')">🍲 Dinner</button>
        <button class="modal-action-btn" (click)="addToDiary('Snack')">🍎 Snack</button>
        <button class="modal-action-btn" (click)="addToDiary('Drinks')">🥤 Drinks</button>
        <button class="modal-action-btn back-btn" (click)="toggleMealOptions()">← Back</button>
      </div>
    </div>
  </div>
</div>