<div *ngIf="product" class="min-h-screen p-4 bg-[#1a1a2e] max-w-4xl mx-auto" [ngClass]="{
    'text-[#0abdc6]': verdict === 'good',
    'text-[#f038ff]': verdict === 'bad'
  }">
  <div class="mb-5">
    <app-button variant="link" (onClick)="goBack()" class="text-[#0abdc6] hover:text-[#f038ff]">← Back</app-button>
  </div>

  <div class="text-center p-8 rounded-xl mb-5 animate-fade-in border" [ngClass]="{
      'border-[#0abdc6] shadow-lg shadow-[#0abdc6]/50': verdict === 'good',
      'border-[#f038ff] shadow-lg shadow-[#f038ff]/50': verdict === 'bad'
    }" style="background: rgba(15, 15, 30, 0.8);">
    <div class="text-6xl mb-4 drop-shadow-lg animate-pop-in" [ngClass]="{
        'text-[#0abdc6]': verdict === 'good',
        'text-[#f038ff]': verdict === 'bad'
      }">
      <span *ngIf="verdict === 'good'">✓</span>
      <span *ngIf="verdict === 'bad'">✗</span>
    </div>
    <h2 class="text-3xl font-bold" [ngClass]="{
        'text-[#0abdc6]': verdict === 'good',
        'text-[#f038ff]': verdict === 'bad'
      }">
      <span *ngIf="verdict === 'good'">Fat Boy Approved!</span>
      <span *ngIf="verdict === 'bad'">Contains Items You Avoid</span>
    </h2>
  </div>

  <div class="text-center mb-8 text-[#e0e0e0]">
    <img [src]="product.image" alt="{{product.name}}" class="w-36 h-36 object-cover rounded-lg mb-4 mx-auto border-2 border-[#4a4a6e]">
    <h3 class="text-2xl font-semibold mb-1">{{product.name}}</h3>
    <p class="text-lg text-[#a0a0c0] mb-2">{{product.brand}}</p>
    <p class="text-sm text-[#a0a0c0]">Scanned on: {{ product.scanDate | date:'mediumDate' }}</p>
  </div>

  <div class="bg-gray-900/80 p-6 rounded-xl mb-5 border border-[#4a4a6e] text-[#e0e0e0]">
    <h3 class="text-xl font-semibold text-[#0abdc6] mb-4 pb-3 border-b border-[#2a2a4e]">Product Details</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="bg-[#2a2a4e] p-4 rounded-md border border-[#4a4a6e] text-sm">
        <strong class="block text-[#f038ff] mb-1">Barcode:</strong> <span class="text-[#e0e0e0]">{{ product.barcode || 'N/A' }}</span>
      </div>
      <div class="bg-[#2a2a4e] p-4 rounded-md border border-[#4a4a6e] text-sm">
        <strong class="block text-[#f038ff] mb-1">Calories:</strong> <span class="text-[#e0e0e0]">{{ product.calories || 'N/A' }} kcal</span>
      </div>
      <div class="bg-[#2a2a4e] p-4 rounded-md border border-[#4a4a6e] text-sm col-span-1 md:col-span-2">
        <strong class="block text-[#f038ff] mb-1">Categories:</strong>
        <div class="flex flex-wrap gap-2 mt-2">
          <span *ngFor="let category of product.categories" class="bg-[#1a1a2e] px-3 py-1 rounded-full text-xs text-[#a0a0c0] border border-[#2a2a4e]">
            {{ category | customTitleCase }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-gray-900/80 p-6 rounded-xl mb-5 border border-[#4a4a6e] text-[#e0e0e0]">
    <h3 class="text-xl font-semibold text-[#f038ff] mb-4 pb-3 border-b border-[#2a2a4e]">Why this rating?</h3>
    <ul class="list-none pl-0">
      <li *ngFor="let item of flaggedItems" class="mb-2 text-[#f038ff] font-bold">
        ⚠️ <strong>{{item.ingredient}}:</strong> {{item.reason}}
      </li>
      <li *ngIf="flaggedItems.length === 0" class="text-[#0abdc6] font-bold">
        No ingredients match your avoid list.
      </li>
    </ul>
  </div>

  <div class="bg-gray-900/80 p-6 rounded-xl mb-8 border border-[#4a4a6e] text-[#e0e0e0]">
    <h3 class="text-xl font-semibold text-[#0abdc6] mb-4 pb-3 border-b border-[#2a2a4e]">Full Ingredients List:</h3>
    <p class="text-sm leading-relaxed text-left text-[#e0e0e0]">{{ product.ingredients.join(', ') }}</p>
  </div>

  <div *ngIf="product.ocrText" class="bg-gray-900/80 p-6 rounded-xl mb-8 border border-[#4a4a6e] text-[#e0e0e0]">
    <h3 class="text-xl font-semibold text-[#0abdc6] mb-4 pb-3 border-b border-[#2a2a4e]">Raw Scanned Text:</h3>
    <p class="font-mono text-sm whitespace-pre-wrap break-all text-left text-[#e0e0e0]">{{ product.ocrText }}</p>
  </div>

  <div class="flex justify-center gap-4 flex-wrap">
    <app-button variant="default" (onClick)="addToList()">Add to...</app-button>
    <app-button variant="outline" (onClick)="scanAgain()">Scan Another</app-button>
    <app-button variant="ghost" (onClick)="shareProduct()">Share</app-button>
    <app-button variant="ghost" (onClick)="addComments()">Add Comments/Details</app-button>
  </div>
</div>