<div class="unified-scanner-container">
  <div class="camera-preview">
    <!-- Html5Qrcode will render its video stream inside this div -->
    <div id="reader" #reader class="barcode-reader-container"></div> 
    <canvas #canvasElement class="capture-canvas" style="display: none;"></canvas>
  </div>

  <!-- New Immersive Header -->
  <div class="scanner-header">
    <div class="header-left">
      <button class="header-btn" (click)="uiService.toggleMenu()" title="Open Menu">
        <lucide-icon name="menu" [size]="24"></lucide-icon>
      </button>
      <button class="header-btn" routerLink="/console">
        <lucide-icon name="message-circle" [size]="24"></lucide-icon>
      </button>
    </div>
    <div class="header-title">
      <app-logo></app-logo>
      <!-- Changed title to be more consistent with main app branding -->
      <div class="title-text">
        <span>Fat Boy Time</span>
        <span class="scanner-subtitle">Scanner</span>
      </div>
    </div>
    <div class="header-right">
      <!-- Add notification button to scanner header -->
      <button class="notification-btn" (click)="toggleNotifications()">
        <lucide-icon name="bell" [size]="24"></lucide-icon>
        <span *ngIf="(unreadNotifications$ | async) as count" class="notification-badge" [class.visible]="count > 0">
          {{ count }}
        </span>
      </button>
      <button *ngIf="cameras.length > 1" (click)="switchCamera()" class="header-btn" title="Switch Camera">
        <lucide-icon name="refresh-cw" [size]="24"></lucide-icon>
      </button>
    </div>
  </div>
  
  <div class="viewfinder">
    <div class="tagline">
      <span class="tagline-word">Scan.</span>
      <span class="tagline-word">Know.</span>
      <span class="tagline-word">Choose.</span>
    </div>
    <div class="scan-area" [class.stable]="isStable">
      <div *ngIf="isScanningBarcode || isProcessingOcr" class="scan-line"></div>
    </div>
    <p>{{ isStable ? 'Analyzing...' : 'Hold steady to scan a label' }}</p>
  </div>

  <!-- New Immersive Footer -->
  <div class="scanner-footer">
    <button class="footer-btn" routerLink="/manual-entry">
      <lucide-icon name="edit-3" [size]="24"></lucide-icon>
      <span>Manual</span>
    </button>
    <button class="capture-btn" (click)="captureLabelForOcr()">
      <div class="capture-inner-ring"></div>
    </button>
    <button class="footer-btn" (click)="toggleVoiceListening()" [class.active]="isVoiceListening">
      <lucide-icon name="mic" [size]="24"></lucide-icon>
      <span>Voice</span>
    </button>
  </div>
</div>

<!-- Notifications panel, similar to app.component.html -->
<app-notifications *ngIf="showNotifications" (close)="showNotifications = false"></app-notifications>